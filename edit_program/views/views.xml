<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <record id="id_sale_coupon_program_view_promo_program_form_inh" model="ir.ui.view">
            <field name="name">coupon.program.form</field>
            <field name="model">coupon.program</field>
            <field name="inherit_id" ref="coupon.coupon_program_view_promo_program_form"/>
            <field name="arch" type="xml">
                <xpath expr="//div[@name='rule_minimum_amount']" position="after">
                    <label for="maximum_purchase_of"/>
                    <div name="maximum_purchase_of" class="o_row">
                        <field name="maximum_purchase_of" widget='monetary'
                               options="{'currency_field': 'currency_id'}"/>
                        <field name="rule_maximum_amount_tax_inclusion" required="1"/>
                    </div>
                </xpath>
                <xpath expr="//field[@name='rule_products_domain']" position="after">
                    <field name="product_ids" widget="many2many_tags"/>
                </xpath>
            </field>
        </record>

        <record id="id_view_order_form_with_carrier" model="ir.ui.view">
            <field name="name">delivery.sale.order.form.view.with_carrier</field>
            <field name="model">sale.order</field>
            <field name="inherit_id" ref="sale.view_order_form"/>
            <field name="arch" type="xml">
                <xpath expr="//notebook" position="inside">
                    <page string="Exception Prouduct">
                        <field name="order_line_ids">
                            <tree>
                                <field name="sequence" widget="handle"/>
                                <!-- We do not display the type because we don't want the user to be bothered with that information if he has no section or note. -->
                                <field name="display_type" invisible="1"/>
                                <field name="product_uom_category_id" invisible="1"/>

                                <field name="product_updatable" invisible="1"/>
                                <field name="product_id"
                                       attrs="{                                             'readonly': [('product_updatable', '=', False)],                                             'required': [('display_type', '=', False)],                                         }"
                                       options="{'no_open': True}" force_save="1"
                                       context="{                                             'partner_id': parent.partner_id,                                             'quantity': product_uom_qty,                                             'pricelist': parent.pricelist_id,                                             'uom':product_uom,                                             'company_id': parent.company_id,                                             'default_lst_price': price_unit,                                             'default_description_sale': name                                         }"
                                       domain="[('sale_ok', '=', True), '|', ('company_id', '=', False), ('company_id', '=', parent.company_id)]"
                                       widget="product_configurator"/>
                                <field name="product_template_id" string="Product" invisible="1"
                                       attrs="{                                           'readonly': [('product_updatable', '=', False)],                                           'required': [('display_type', '=', False)],                                       }"
                                       options="{'no_open': True}"
                                       context="{                                           'partner_id': parent.partner_id,                                           'quantity': product_uom_qty,                                           'pricelist': parent.pricelist_id,                                           'uom':product_uom,                                           'company_id': parent.company_id,                                           'default_list_price': price_unit,                                           'default_description_sale': name                                       }"
                                       domain="[('sale_ok', '=', True), '|', ('company_id', '=', False), ('company_id', '=', parent.company_id)]"
                                       widget="product_configurator"/>
                                <field name="name" widget="section_and_note_text" optional="show"/>
                                <field name="analytic_tag_ids" optional="hide" groups="analytic.group_analytic_tags"
                                       widget="many2many_tags" options="{'color_field': 'color'}"
                                       domain="['|', ('company_id', '=', False), ('company_id', '=', parent.company_id)]"/>
                                <field name="product_uom_qty"
                                       decoration-info="(not display_type and invoice_status == 'to invoice')"
                                       decoration-bf="(not display_type and invoice_status == 'to invoice')"
                                       context="{                                             'partner_id': parent.partner_id,                                             'quantity': product_uom_qty,                                             'pricelist': parent.pricelist_id,                                             'uom': product_uom,                                             'company_id': parent.company_id                                         }"/>
                                <field name="qty_delivered"
                                       decoration-info="(not display_type and invoice_status == 'to invoice')"
                                       decoration-bf="(not display_type and invoice_status == 'to invoice')"
                                       string="Delivered"
                                       attrs="{                                             'column_invisible': [('parent.state', 'not in', ['sale', 'done'])],                                             'readonly': [('qty_delivered_method', '!=', 'manual')]                                         }"
                                       optional="show"/>
                                <field name="qty_delivered_manual" invisible="1"/>
                                <field name="qty_delivered_method" invisible="1"/>
                                <field name="qty_invoiced"
                                       decoration-info="(not display_type and invoice_status == 'to invoice')"
                                       decoration-bf="(not display_type and invoice_status == 'to invoice')"
                                       string="Invoiced"
                                       attrs="{'column_invisible': [('parent.state', 'not in', ['sale', 'done'])]}"
                                       optional="show"/>
                                <field name="qty_to_invoice" invisible="1"/>
                                <field name="product_uom_readonly" invisible="1"/>
                                <field name="product_uom" force_save="1" string="UoM"
                                       attrs="{                                             'readonly': [('product_uom_readonly', '=', True)],                                             'required': [('display_type', '=', False)],                                         }"
                                       context="{'company_id': parent.company_id}" groups="uom.group_uom"
                                       options="{&quot;no_open&quot;: True}" optional="show"/>
                                <field name="customer_lead" optional="hide"
                                       attrs="{'readonly': [('parent.state', 'not in', ['draft', 'sent', 'sale'])]}"/>
                                <field name="price_unit" attrs="{'readonly': [('qty_invoiced', '&gt;', 0)]}"/>
                                <field name="tax_id" widget="many2many_tags" options="{'no_create': True}"
                                       domain="[('type_tax_use','=','sale'),('company_id','=',parent.company_id)]"
                                       attrs="{'readonly': [('qty_invoiced', '&gt;', 0)]}" optional="show"/>
                                <field name="discount" string="Disc.%" groups="product.group_discount_per_so_line"
                                       optional="show" widget="product_discount"/>
                                <field name="price_subtotal" widget="monetary"
                                       groups="account.group_show_line_subtotals_tax_excluded"/>
                                <field name="price_total" widget="monetary"
                                       groups="account.group_show_line_subtotals_tax_included"/>
                                <field name="state" invisible="1"/>
                                <field name="invoice_status" invisible="1"/>
                                <field name="currency_id" invisible="1"/>
                                <field name="price_tax" invisible="1"/>
                                <field name="company_id" invisible="1"/>
                            </tree>
                        </field>
                    </page>
                </xpath>
            </field>
        </record>


    </data>
</odoo>